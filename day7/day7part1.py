INPUT = """
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^...^....................................................................
.............................................................................................................................................
...................................................................^.^.^.^...................................................................
.............................................................................................................................................
..................................................................^.^.^...^..................................................................
.............................................................................................................................................
.................................................................^.^.^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.^.^.^.^...^................................................................
.............................................................................................................................................
...............................................................^.^.^...^.^.^.^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^.^.^...^.^..............................................................
.............................................................................................................................................
.............................................................^.^.......^...^.^.^.............................................................
.............................................................................................................................................
............................................................^.^.^.^.^...^.^.^.^.^............................................................
.............................................................................................................................................
...........................................................^.^.^.^.^.^.^.^...^.^.^...........................................................
.............................................................................................................................................
..........................................................^.....^.^.^.^.......^.^.^..........................................................
.............................................................................................................................................
.........................................................^...^.^.^.^.^...^.^.^.....^.........................................................
.............................................................................................................................................
........................................................^.....^.^.....^.^.^.^.....^.^........................................................
.............................................................................................................................................
.......................................................^...^.^.^.......^...^...^.^.^.^.......................................................
.............................................................................................................................................
......................................................^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^...^...^...........^.^.^.^.^.....................................................
.............................................................................................................................................
....................................................^.^...^.^.....^.^...^.^.^.^.^...^...^....................................................
.............................................................................................................................................
...................................................^.^...^...^...^...^.^.^.^.^...^.^.^.^.^...................................................
.............................................................................................................................................
..................................................^.....^.^.....^.^.^.^.^.^...^.^.....^.^.^..................................................
.............................................................................................................................................
.................................................^.^.^...^.^.^.....^.^.^.^.^.....^.^.^...^.^.................................................
.............................................................................................................................................
................................................^...^...^...^.^.^.........^.^.^.^.^.^.......^................................................
.............................................................................................................................................
...............................................^.^.^.^...^.^.^.......^.^.........^.^.^.^.....^...............................................
.............................................................................................................................................
..............................................^.^.^...^.^.^.^.^.^...^.^.....^.......^.^.^...^.^..............................................
.............................................................................................................................................
.............................................^.^.^.^.^.^...^.^.^.....^.^.^.^.^.^.^.....^.^.^.^.^.............................................
.............................................................................................................................................
............................................^.^.^...^.^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^...^.^.^............................................
.............................................................................................................................................
...........................................^.^.^.^.^.^.^.^.^.^...^.^.............^.^.^.........^.^...........................................
.............................................................................................................................................
..........................................^.^.^.....^.^.^.^...^.^.^.^.^.^...^.^.^.^.^.^...^.^.^...^..........................................
.............................................................................................................................................
.........................................^.^...^.^.^.^.^.^.......^.^...^.^.^.^...^...^.^.^...^.^.^.^.........................................
.............................................................................................................................................
........................................^.^.^.^.^.^...^...^.^.^.....^.^.^...^.^.^.^.^.^...^.^.^...^.^........................................
.............................................................................................................................................
.......................................^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.......^...^.^...^.^.^...^.......................................
.............................................................................................................................................
......................................^.^.^.^...^.^...^.^.^.^.^.^.^.^.^.....^.^...^.^.....^.^.^...^...^......................................
.............................................................................................................................................
.....................................^.^.^.^.^.^.^.^...^.^.^...^.....^.^...^.^.^.^.....^.^...^...^.^.^.^.....................................
.............................................................................................................................................
....................................^...^.^.^.....^.^.^.^.^...^...^...^.^.^.^.^.^.^...^.^.^.^.^...^...^.^....................................
.............................................................................................................................................
...................................^...^...^...^.^.^.....^.^...^.^.^.^.^.....^.^.^.^.^.^.....^...^.^.^...^...................................
.............................................................................................................................................
..................................^.^.^.^.^...^.....^.....^.......^.^.....^.^...^...^.^.^...^.....^.^.^.^.^..................................
.............................................................................................................................................
.................................^.^.....^.^.^.^.......^.......^.^.^.^.^.^...^.^...^.^.^...^...^.^...^.....^.................................
.............................................................................................................................................
................................^.^.^.^.^...^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.....^.^.^.....^.^.^.^...^.....^................................
.............................................................................................................................................
...............................^.^...^.^.^...^...^.^.....^.....^.^.^.^...^.....^...^...^...^.^.^.^.^.....^.^.^...............................
.............................................................................................................................................
..............................^.^.....^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.....^...^...^.^..............................
.............................................................................................................................................
.............................^.^.^.^.........^.....^.^.^...^...^.^.^.^.^...^...^.^.^.^.^.^.^...^.^.^.^...^.^...^.............................
.............................................................................................................................................
............................^.^.^.^.^.^.^.^...^.^.....^.^...^.^.^.^.^.....^.^.^.^...^.^.^.^.^...^...^...^...^.^.^............................
.............................................................................................................................................
...........................^.^...^.^.^.^.^.^...^.^.^.....^...^.^.^.^.^...^...^.^...^.^.......^.^.^...^.^.^.^.^.^.^...........................
.............................................................................................................................................
..........................^.^...^.^.^.^.^.^.^.........^.^...^.^.^.^.^.^.^.......^.^.^...^.^...^...^.^.^.^.^...^.^.^..........................
.............................................................................................................................................
.........................^.....^.^.^.^.^.^...^.^.^.^.....^.^.^...^.^.....^.^.^.^.^.^...^...^.^.....^.^.....^.^.^.^.^.........................
.............................................................................................................................................
........................^...^...^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^.^.....^.^...^...^...^.^.^.^.^.^.......^.^.^.^.^...^........................
.............................................................................................................................................
.......................^.^.^...^.^.......^.^.^.^.^.^...^.^.......^.^.^...^.^...^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.......................
.............................................................................................................................................
......................^.^.^.^...^.^.^.^.^.^.^...^.......^.^...^...^...^...^...^...^.....^...^.^.^.^...^.^.^...^.^.^.^.^......................
.............................................................................................................................................
.....................^.^.^...^.^...^.^...^.....^...^.^.^.^.....^.^...^.^.^.^.....^...^.......^.^.^...^.....^.^.^.....^.^.....................
.............................................................................................................................................
....................^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.....^...^.^.^.^.^...^.^.^.^.^.^.^...^.^.......^...^.^.^.^.^.^.^.....^....................
.............................................................................................................................................
...................^.^.....^.....^...^.^...^...^...^.^.^...^.......^.^...^...^.^.^.^.^.^.^.^...^.^.^.^.^...^.^...^...^.^.^...................
.............................................................................................................................................
..................^...^.^.^.^.^.^.^.^.^.^.^.^.....^...^...^...^.^.^.^.^.^.^.^.^...^.....^...^...^.^.^.^.^.....^...^.^.^.^.^..................
.............................................................................................................................................
.................^.^.^.^.....^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.....^.^.^...^.^.^...^.......^.....^.^...^...^.......^.^.................
.............................................................................................................................................
................^.^...^.....^.^...^.^...^.^.^...^.^.^.^...^.^.^.^.....^.^...^.^...^.^...^.^.....^.^.^.....^.^.^.^.^.^...^...^................
.............................................................................................................................................
...............^.^.....^.^.^.^.^.^.^.^...^.^...^.^...^.^.^...^.^.....^.^...^.^.^.^.^.........^.^...^.^.^...^.^.^.....^...^.^.^...............
.............................................................................................................................................
..............^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.........^.^.^.^.^...^.^.^.^..............
.............................................................................................................................................
.............^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.........^.^...^.^.^.....^.^...^.^.^...^.^.^...^.^...^...^...^...^.^.^.^.^.^...^.^.............
.............................................................................................................................................
............^.^.....^.^...^.^.^.^.......^.^.^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^...^.^...^.^.^...^.^.^.^.^.^.^...^............
.............................................................................................................................................
...........^.^.^...^.^.^.^.^...^...^.^.^.....^.^...^.^.^...^.^.^...^.^.^.^...^...^.^.....^...^.^.....^.^.^.^.^.^.^.^...^.......^.^...........
.............................................................................................................................................
..........^.^.^.^.^.^...^...^.^.^.^.^.^.....^.^.^.^.^...^...^.^.^...^.^.^.^.^...^.^.^.^.....^.^.^.^.^.^.^.^.^.^.^.....^.^.^.......^..........
.............................................................................................................................................
.........^.^.^.^.^...^.^...^...^.....^.^...^.^...^.^.^.^.^.^.........^.^.^.^.^...^.^.^...^.^.^.^.^...^.....^.^.^.^.^.^.^.^.^.^.^...^.........
.............................................................................................................................................
........^...^.....^.^.......^...^.^.^.^.....^.^.^.^.......^.^...^.^.^.^.^.^.^.^.^.^.^.....^...^.^.....^...^.^.^.^.^...^...^.....^.^.^........
.............................................................................................................................................
.......^.^.^.^.^.^...^.^.^...^.^...^...^.......^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.....^.^.^.^...^.^.^.......
.............................................................................................................................................
......^.^.^.^.......^.^.^.^.....^.^.^...^.^.^.^.^...^...^...^.^.^.........^.....^.^.^.^.^.^.....^.......^.^.......^.....^.^.^.^.^.....^......
.............................................................................................................................................
.....^.^.^.^.....^.^.^...^...^.......^.^...^.....^.^.^.^.^...^...^.^.^.^...^.^.^.^.^.^.^.^.^...^.......^...^.........^.^.^.^...^.^...^.^.....
.............................................................................................................................................
....^.^.^.^.^.^.^.^.^.^...^.^...^.^.^...^.^.^.^...^.^...^.^.^.^...^...^.^.^.^.^.^.^...^.^.^...^.......^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...^....
.............................................................................................................................................
...^...^.^.^.^...^.^...^.^.....^.^.^.^.^.^.^.^.^.....^.^.^...^...^.^.^.^.^...^...^.^.^.^...^.^.^.^.^...^...^.^.^.^.^...^.^.^.^.....^.....^...
.............................................................................................................................................
..^.^...^...^.^.^.^...^.^.^...^.^.^.^.^.....^...^...^.^.^.....^.^.....^.^.^...^.....^.^...^.^.^.^...^.......^.^.....^.^.......^.^.......^.^..
.............................................................................................................................................
.^...^.^.^.^.^.^.....^.^.^.........^.^...^.^.^.^...^.^.^.^...^.^.........^.^...^.....^...^.^.^.^.^.^.^...^...^.^.^.........^.^.^.^.^.^.^.^.^.
.............................................................................................................................................
""".strip("\n")


def solve(grid):
    grid = grid.split("\n")
    H = len(grid)
    W = len(grid[0])

    # Locate S
    for r in range(H):
        for c in range(W):
            if grid[r][c] == "S":
                start_row = r
                start_col = c

    split_count = 0

    # beams[c] = beam entering this row from above
    beams = [False] * W

    for r in range(H):

        # Activate beam at S location
        if r == start_row:
            beams[start_col] = True

        # Active beams for this row
        active = [c for c in range(W) if beams[c]]
        down = [False] * W  # beams continuing downward
        visited = [False] * W  # avoid reprocessing cells

        # Resolve splitting sideways until stable
        while active:
            next_active = []

            for c in active:
                if visited[c]:
                    continue
                visited[c] = True

                cell = grid[r][c]

                if cell == "^":
                    # Split event
                    split_count += 1

                    # Spawn left and right beams
                    left = c - 1
                    right = c + 1

                    if left >= 0 and not visited[left]:
                        next_active.append(left)
                    if right < W and not visited[right]:
                        next_active.append(right)

                else:
                    # Empty or S â†’ beam goes downward untouched
                    down[c] = True

            active = next_active

        # Prepare beams entering the next row
        beams = down

    return split_count


# -------------------------------
# Run the solution
# -------------------------------
print("Total splits =", solve(INPUT))
